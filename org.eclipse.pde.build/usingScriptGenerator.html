<html>
<title>Using PDE Core to build Plug-ins, Fragments and Features</title>
<body>
<p>
<h1><font color="red">This document is a work in progress.</font></h1>
</p>
<br>
<h1>BTW, what is PDE Core?</h1>
<p>
        To be written...
</p>
<br>
<h1>Features:</h1>
<p>
        To be written...
</p>
<h1>Plug-ins:</h1>
<h3>How do I build a plug-in using PDE Core?</h3>
<p>
Actually, PDE Core does not build plug-ins. It only generates Ant scripts that will do the job.
</p>
<p>
One way to generate a build.xml script for a plug-in is through the command line. EXPLAIN WHAT IS THE CORRECT SETUP
<pre>
java -cp startup.jar org.eclipse.core.launcher.Main -dev bin -application org.eclipse.pde.core.plugin -plugin org.eclipse.core.resources
java -cp startup.jar org.eclipse.core.launcher.Main -dev bin -application org.eclipse.ant.core.antRunner -file plugins\org.eclipse.core.resources\plugin.xml
</pre>
</p>
<p>
Another way is calling an Ant task provided by PDE Core:
<pre>
To be written...
&lt;buildscript elements="org.eclipse.pde.core.plugin"/&gt;
</pre>
</p>


<h1>Fragments:</h1>
<p>
        To be written...
</p>
<br>
<h1>General information:</h1>

<h3>How can a plug-in provide its own build.xml and not rely on PDE Core?</h3>
<p>
The plug-in only needs to provide 2 files: <b>build.xml</b> and <b>build.properties</b>.
<ul>
  <li>
       <b>build.xml</b> is the Ant script responsible for building the current plug-in
  </li>
  <li>
       <b>build.properties</b> should contain the entry <b>custom=true</b> to indicate that PDE Core
       should not generate scripts for this plug-in
  </li>
</ul>
</p>

<h3>How to provide platform dependent variables on the build.properties file?</h3>
<p>
It is only necessary to append <b>${variables here}.</b> as a prefix of the property. The available
variables are <b>os</b>, <b>ws</b>, <b>nl</b> and <b>arch</b>. They can also be used together. The
examples bellow illustrate it better:
<ul>
  <li>
       <b>${os/linux,ws/motif}.bin.includes=src/linux</b> indicates that the folder <b>src/linux</b> should
       be include to the bin target if os=linux and ws=motif
  </li>
  <li>
       <b>${os/*,ws/motif}.bin.includes=src/linux</b> indicates that the folder <b>src/linux</b> should
       be include to the bin target if ws=motif on any os.
  </li>
</ul>
</p>

<br><br>
<h3><...more to come...></h3>
</p>

<br><br>
<p>
<h1><font color="red">Old text being rewritten:</font></h1>
</p>
<pre>
Command Line Usage

The ant script generation facilities reside in the following classes:

* PluginBuildScriptGenerator: generates build.xml files for one or more specified plug-ins
* FragmentBuildScriptGenerator: generates build.xml files for one or more specified fragments
* ComponentBuildScriptGenerator: generates the build.xml file for a specified component, and
  optionally invokes generation of build.xml files for all contained plug-ins and fragments as well
* ConfigurationBuildScriptGenerator: generates the build.xml file for a specified configuration,
  and optionally invokes generation of build.xml files for all contained components, plug-ins and
  fragments as well

The command-line switches for these generators are:

PluginBuildScriptGenerator
-install directoryName: specifies the root directory of the target eclipse platform
-plugins pluginPath: optional, specifies base directory for plug-ins
-plugin pluginId: specifies the id of a plug-in to generate; any number of these may be specified
-dev classPathEntries: optional, sets the additional development model class path entries

FragmentBuildScriptGenerator
-install directoryName: specifies the root directory of the target eclipse platform
-plugins fragmentPath: optional, specifies base directory for fragments
-fragment fragmentId: specifies the id of a fragment to generate; any number of these may be specified
-dev classPathEntries: optional, sets the additional development model class path entries

ComponentBuildScriptGenerator
-install directoryName: specifies the root directory of the target eclipse platform
-nochildren: optional, specifies that script generation for contained plug-ins and fragments should not be invoked
-component: the id of the component to generate

ConfigurationBuildScriptGenerator
-install directoryName: specifies the root directory of the target eclipse platform
-nochildren: optional, specifies that script generation for contained components should not be invoked
-configuration: the id of the configuration to generate


Build Specifications for Plug-ins and Fragments

The build mechanism is driven by a build specification. The specification for an individual plug-in,
fragment, component or configuration is found in a build.properties file in the corresponding element.
This file describes where to find the source code for the element.  Other entries describe which files
should be included/excluded in/from various forms of distribution (e.g., binary, source, doc).

Specifying Source for Plug-ins and Fragments

Plug-ins requiring compilation must define a build.properties file in order to specify the location of
their source.  This file is a simple properties file.  The properties must be of form
source.<jarName>=<source directories>, where source directories can be a comma-separated list if needed.
For example:

source.resources.jar=src

Substitutable Values

Plugins and Fragments

There are currently six points where text can be specified by a plug-in or fragment for inclusion
in its generated build.xml file.  These points are:

bin.includes
bin.excludes
javadoc.packages
javadoc.excludedpackages
src.includes
src.excludes

The values defined in these points are expressed as Ant "patterns".  Typically this amounts to a
comma-separated list of strings to match.  Standard formats give the expected results
(e.g., *.jar indicates all jar files in the top level directory, etc).  There are a few
hints/shortcuts.  The patterns are not deep by default.  If you want to describe all Java files for
example, you should use the patter "**/*.java". "**" matches any number of directory levels.
Similarly, to describe whole subtrees, use "foo/".

Default values for these points are always automatically generated with identifiers of form
auto.<lastPortionOfPointId>.  This is done to allow your override to extend these default
values if desired.  To set override values, a plug-in defines additional name/value properties
in the previously-mentioned build.properties file.  Some examples:

bin.includes=plugin.xml,*.jar
javadoc.packages=${auto.packages},org.eclipse.core.target.*
src.excludes=${auto.excludes},*Hack.java

Components and Configurations

There are currently two points where text can be specified by a component or configuration
for inclusion in its generated build.xml file.  These points are:

bin.includes
bin.excludes

Default values for these points are always automatically generated with identifiers of form
auto.<lastPortionOfPointId>.  This is done to allow your override to extend these default values if desired.

</pre>


</body>
</html>