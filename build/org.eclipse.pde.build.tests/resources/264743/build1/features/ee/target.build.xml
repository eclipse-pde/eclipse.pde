<?xml version="1.0" encoding="UTF-8"?>
<project name="org.eclipse.platform.launchers" default="build.update.jar" basedir=".">

	<target name="init">
		<property name="feature.destination" value="${basedir}"/>
		<property name="p2.build.repo" value="file:${buildDirectory}/buildRepo"/>
		<condition property="p2.publish.parts" value="true"		>
			<istrue value="${p2.gathering}"/>
		</condition>
	</target>

	<target name="all.plugins" depends="init">
	</target>
	<target name="all.features" depends="init">
	</target>
	<target name="update.feature" depends="init">
	</target>

	<target name="all.children" depends="init,all.features,all.plugins,update.feature">
	</target>

	<target name="children" if="include.children">
		<antcall target="all.children"/>
	</target>

	<target name="build.jars" depends="init" description="Build all the jars for the feature: org.eclipse.platform.launchers.">
	</target>

	<target name="build.sources" depends="init">
	</target>

	<target name="build.zips" depends="init">
	</target>

	<target name="build.update.jar" depends="init" description="Build the feature jar of: org.eclipse.platform.launchers for an update site.">
	</target>
	
	<target name="publish.bin.parts" depends="init" if="p2.publish.parts">
		<eclipse.gatherFeature 
		   metadataRepository="${p2.build.repo}"
		   artifactRepository="${p2.build.repo}"
		   buildResultFolder="${basedir}"
		   baseDirectory="${basedir}"
		/>
	</target>

	<target name="gather.bin.parts" depends="init" if="feature.base">
		<subant target="rootFiles${os}_${ws}_${arch}" buildpath="." failonerror="false" inheritall="true"/>
	</target>
	
	<target name="rootFileswin32_win32_x86">
		<mkdir dir="${feature.base}/win32.win32.x86/${collectingFolder}"/>
		<copy todir="${feature.base}/win32.win32.x86/${collectingFolder}" failonerror="true" overwrite="true">
			<fileset dir="${basedir}/bin/win32/win32/x86">
				<include name="launcher.exe"/>
			</fileset>
		</copy>
		<chmod perm="755" dir="${feature.base}/win32.win32.x86/${collectingFolder}" includes="${launcherName}" /> 
	</target>
		
	<target name="rootFilesmacosx_carbon_ppc">
		<mkdir dir="${feature.base}/macosx.carbon.ppc/${collectingFolder}"/>
		<copy todir="${feature.base}/macosx.carbon.ppc/${collectingFolder}" failonerror="true" overwrite="true">
			<fileset dir="${basedir}/bin/carbon/macosx/ppc" includes="**"			/>
		</copy>
		<chmod perm="755" dir="${feature.base}/macosx.carbon.ppc/${collectingFolder}" includes="${launcherName}" /> 
		<chmod perm="755" dir="${feature.base}/macosx.carbon.ppc/${collectingFolder}" includes="${launcherName}.app/Contents/MacOS/${launcherName}" /> 
		<chmod perm="755" dir="${feature.base}/macosx.carbon.ppc/${collectingFolder}" includes="${launcherName}.app/Contents/Resources/Splash.app/Contents/MacOS/${launcherName}"/>
	</target>
	<target name="rootFileslinux_gtk_x86">
		<mkdir dir="${feature.base}/linux.gtk.x86/${collectingFolder}"/>
		<copy todir="${feature.base}/linux.gtk.x86/${collectingFolder}" failonerror="true" overwrite="true">
			<fileset dir="${basedir}/bin/gtk/linux/x86" includes="**"			/>
			<fileset dir="${basedir}/gtk_root" includes="**"			/>
		</copy>
		<chmod perm="755" dir="${feature.base}/linux.gtk.x86/${collectingFolder}" includes="${launcherName}" /> 
		<chmod perm="755" dir="${feature.base}/linux.gtk.x86/${collectingFolder}" includes="libcairo-swt.so" /> 
	</target>
	<target name="rootFilesgroup_group_group">
		<antcall target="rootFileswin32_win32_x86"/>
		<antcall target="rootFilesmacosx_carbon_ppc"/>
		<antcall target="rootFileslinux_gtk_x86"/>
	</target>

	<target name="zip.distribution" depends="init" description="Create a zip containing all the plug-ins and features for the feature: org.eclipse.platform.launchers.">
	</target>

	<target name="zip.sources" depends="init">
	</target>

	<target name="zip.logs" depends="init">
	</target>

	<target name="clean" depends="init" description="Clean the feature: org.eclipse.platform.launchers of all the zips, jars and logs created.">
	</target>

	<target name="refresh" depends="init" if="eclipse.running" description="Refresh this folder.">
	</target>
	
	<target name="gather.sources">
	</target>

	<target name="gather.logs" depends="init">
	</target>

</project>
